"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[673],{4273:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var t=n(4848),r=n(8453);const a={sidebar_position:5},i="Installing Storage Class",l={id:"installing-storage-class",title:"Installing Storage Class",description:"This is internal documentation. This document can be used only if it was recommended by the Support Team.",source:"@site/docs/installing-storage-class.md",sourceDirName:".",slug:"/installing-storage-class",permalink:"/xl-deploy-kubernetes-helm-chart/docs/installing-storage-class",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Tested Configuration",permalink:"/xl-deploy-kubernetes-helm-chart/docs/tested-configuration"},next:{title:"Installing Helm Chart",permalink:"/xl-deploy-kubernetes-helm-chart/docs/installing-helm-chart"}},o={},c=[{value:"NFS Client Provisioner for On-Premises Kubernetes cluster",id:"nfs-client-provisioner-for-on-premises-kubernetes-cluster",level:2},{value:"Elastic File System for AWS Elastic Kubernetes Service(EKS) cluster",id:"elastic-file-system-for-aws-elastic-kubernetes-serviceeks-cluster",level:2}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.h1,{id:"installing-storage-class",children:"Installing Storage Class"}),"\n",(0,t.jsx)(s.admonition,{type:"caution",children:(0,t.jsx)(s.p,{children:"This is internal documentation. This document can be used only if it was recommended by the Support Team."})}),"\n",(0,t.jsx)(s.p,{children:"If you are using storage class other than NFS and EFS then please proceed with installation steps"}),"\n",(0,t.jsx)(s.h2,{id:"nfs-client-provisioner-for-on-premises-kubernetes-cluster",children:"NFS Client Provisioner for On-Premises Kubernetes cluster"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["For deploying helm chart, ",(0,t.jsx)(s.code,{children:"nfs server"})," and ",(0,t.jsx)(s.code,{children:"nfs mount path"})," are required."]}),"\n",(0,t.jsx)(s.li,{children:"Before installing NFS Provisioner helm chart, you need to add the stable helm repository to your helm client as shown below:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"helm repo add stable https://charts.helm.sh/stable\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To install the chart with the release name ",(0,t.jsx)(s.code,{children:"nfs-provisioner"}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"helm install nfs-provisioner --set nfs.server=x.x.x.x --set nfs.path=/exported/path stable/nfs-client-provisioner\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"nfs-provisioner"})," storage class must be marked with the default annotation so that PersistentVolumeClaim objects (without a StorageClass specified) will trigger dynamic provisioning."]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'kubectl patch storageclass nfs-client -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}\'\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["After deploying the nfs helm chart, execute the below command to get StorageClass name which can be used in values.yaml file for parameter ",(0,t.jsx)(s.code,{children:"Persistence.StorageClass"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl get storageclass\n"})}),"\n",(0,t.jsxs)(s.p,{children:["For more information on nfs-client-provisioner, refer ",(0,t.jsx)(s.a,{href:"https://github.com/helm/charts/tree/master/stable/nfs-client-provisioner",children:"stable/nfs-client-provisioner"})]}),"\n",(0,t.jsx)(s.h2,{id:"elastic-file-system-for-aws-elastic-kubernetes-serviceeks-cluster",children:"Elastic File System for AWS Elastic Kubernetes Service(EKS) cluster"}),"\n",(0,t.jsx)(s.p,{children:"Before deploying EFS helm chart, there are some steps which need to be performed."}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Create your EFS file system. Refer ",(0,t.jsx)(s.a,{href:"https://docs.aws.amazon.com/efs/latest/ug/gs-step-two-create-efs-resources.html",children:"Create Your Amazon EFS File System"})," for creating file system."]}),"\n",(0,t.jsxs)(s.li,{children:["Create a mount target. Refer ",(0,t.jsx)(s.a,{href:"https://docs.aws.amazon.com/efs/latest/ug/accessing-fs.html",children:"Creating mount targets"})," for creating mount target."]}),"\n",(0,t.jsx)(s.li,{children:"Before installing EFS Provisioner helm chart, you need to add the stable helm repository to your helm client as shown below:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"helm repo add stable https://charts.helm.sh/stable\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Provide the ",(0,t.jsx)(s.code,{children:"efsFileSystemId"})," and ",(0,t.jsx)(s.code,{children:"awsRegion"})," which can be obtained by executing above steps. Install the chart with the release name ",(0,t.jsx)(s.code,{children:"aws-efs"}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"helm install aws-efs stable/efs-provisioner --set efsProvisioner.efsFileSystemId=fs-12345678 --set efsProvisioner.awsRegion=us-east-2\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"aws-efs"})," storage class must be marked with the default annotation so that PersistentVolumeClaim objects (without a StorageClass specified) will trigger dynamic provisioning."]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'kubectl patch storageclass aws-efs -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}\'\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"There has to be only one storage class with default setting, so remove other storage classes with default settings."}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:'kubectl patch storageclass gp2 -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"false"}}}\'\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["After deploying the efs helm chart, execute the below command to get StorageClass name which can be used in values.yaml file for parameter ",(0,t.jsx)(s.code,{children:"Persistence.StorageClass"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"kubectl get storageclass\n"})}),"\n",(0,t.jsxs)(s.p,{children:["For more information on efs-provisioner, refer ",(0,t.jsx)(s.a,{href:"https://github.com/helm/charts/tree/master/stable/efs-provisioner",children:"stable/efs-provisioner"})]})]})}function d(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>l});var t=n(6540);const r={},a=t.createContext(r);function i(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);