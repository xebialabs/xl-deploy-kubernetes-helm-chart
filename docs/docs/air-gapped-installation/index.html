<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<title data-react-helmet="true">air-gapped-installation | Deploy Kubernetes Helm Chart</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://xebialabs.github.io/xl-deploy-kubernetes-helm-chart/docs/air-gapped-installation"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="air-gapped-installation | Deploy Kubernetes Helm Chart"><meta data-react-helmet="true" name="description" content="This is internal documentation. This document can be used only if it was recommended by the Support Team."><meta data-react-helmet="true" property="og:description" content="This is internal documentation. This document can be used only if it was recommended by the Support Team."><link data-react-helmet="true" rel="shortcut icon" href="/xl-deploy-kubernetes-helm-chart/img/digital_ai_deploy.svg"><link data-react-helmet="true" rel="canonical" href="https://xebialabs.github.io/xl-deploy-kubernetes-helm-chart/docs/air-gapped-installation"><link data-react-helmet="true" rel="alternate" href="https://xebialabs.github.io/xl-deploy-kubernetes-helm-chart/docs/air-gapped-installation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://xebialabs.github.io/xl-deploy-kubernetes-helm-chart/docs/air-gapped-installation" hreflang="x-default"><link rel="stylesheet" href="/xl-deploy-kubernetes-helm-chart/assets/css/styles.22a8eaea.css">
<link rel="preload" href="/xl-deploy-kubernetes-helm-chart/assets/js/runtime~main.2d393b82.js" as="script">
<link rel="preload" href="/xl-deploy-kubernetes-helm-chart/assets/js/main.28544d81.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/xl-deploy-kubernetes-helm-chart/"><div class="navbar__logo"><img src="/xl-deploy-kubernetes-helm-chart/img/digital_ai_deploy.svg" alt="Deploy Kubernetes Helm Chart Digital.ai" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/xl-deploy-kubernetes-helm-chart/img/digital_ai_deploy.svg" alt="Deploy Kubernetes Helm Chart Digital.ai" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Deploy Kubernetes Helm Chart</b></a><a class="navbar__item navbar__link navbar__link--active" href="/xl-deploy-kubernetes-helm-chart/docs/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/xebialabs/xl-deploy-kubernetes-helm-chart" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">🌜</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">🌞</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/prerequisites">prerequisites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/chart">chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/tested-configuration">tested-configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/installing-storage-class">installing-storage-class</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/installing-helm-chart">installing-helm-chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/upgrading-helm-chart">upgrading-helm-chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/uninstalling-helm-chart">uninstalling-helm-chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/access-dashboard">access-dashboard</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/parameters">parameters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/development">development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/useful-links">useful-links</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/building-operator-image">building-operator-image</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/make-custom-configuration">make-custom-configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/integrating-with-identity-service">integrating-with-identity-service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/xl-deploy-kubernetes-helm-chart/docs/air-gapped-installation">air-gapped-installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/xl-deploy-kubernetes-helm-chart/docs/operator-rbac">operator-rbac</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>air-gapped-installation</h1></header><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>This is internal documentation. This document can be used only if it was recommended by the Support Team.</p></div></div><header><h1>Deploy Installation on a Air-gapped K8S Cluster</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="requirements">Requirements<a aria-hidden="true" class="hash-link" href="#requirements" title="Direct link to heading">​</a></h2><ul><li>Running k8s cluster</li><li><code>kubectl</code> connected to the cluster</li><li><code>xl-cli</code> installed - version 23.3.x (any version above 23.1.x)</li><li>Deploy operator - version 23.3.x (any version above 23.1.x)</li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="installation-steps">Installation steps<a aria-hidden="true" class="hash-link" href="#installation-steps" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="download-matching-version-of-the-xl-op-blueprints">Download matching version of the xl-op-blueprints<a aria-hidden="true" class="hash-link" href="#download-matching-version-of-the-xl-op-blueprints" title="Direct link to heading">​</a></h3><p>Check what you need with <code>xl kube help</code>, for example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">❯ xl kube help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Install, upgrade or clean Digital.ai Deploy or Digital.ai Release on a Kubernetes cluster using operator technology.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Installation blueprint files are used from https://dist.xebialabs.com/public/xl-op-blueprints/23.3.x/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">You need to have kubectl installed and configured for the target Kubernetes cluster.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can see from here that <code>xl kube</code> needs blueprints from location <a href="https://dist.xebialabs.com/public/xl-op-blueprints/23.3.x/" target="_blank" rel="noopener noreferrer">https://dist.xebialabs.com/public/xl-op-blueprints/23.3.x/</a>
(Note: 23.3.x denotes the appropriate version of <code>xl-op-blueprints</code> pointed by <code>xl</code>. Use the specific version in your case.)</p><p>You need to download and put all files from that location to the server where you will execute <code>xl kube</code>.</p><p>:::TIP
You can download zipped version of the xl-op-blueprints from here:
<a href="https://nexus.xebialabs.com/nexus/content/repositories/digitalai-public/ai/digital/xlclient/blueprints/xl-op-blueprints/" target="_blank" rel="noopener noreferrer">https://nexus.xebialabs.com/nexus/content/repositories/digitalai-public/ai/digital/xlclient/blueprints/xl-op-blueprints/</a></p><p>Unzip it to the server where you will execute <code>xl kube</code>.
:::</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="get-the-operator-related-images-to-your-image-registry">Get the operator related images to your image registry<a aria-hidden="true" class="hash-link" href="#get-the-operator-related-images-to-your-image-registry" title="Direct link to heading">​</a></h3><p>The kubernetes cluster running in airgapped environment cannot download any image from public registry (such as docker.io, gcr.io, quay.io). The images need to be pushed to a image registry accessible to the kubernetes cluster. Create either a private image repository on your cloud provider or a local image repository that is accessible to the kubernetes cluster.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="prerequisite-images">Prerequisite Images<a aria-hidden="true" class="hash-link" href="#prerequisite-images" title="Direct link to heading">​</a></h4><p>Push the images according to your planned installation to your image repository.
For example, for version 23.3.x, following is the list of the images that you will need:</p><ul><li>docker.io/xebialabs/xl-deploy:23.3.x</li><li>docker.io/xebialabs/deploy-task-engine:23.3.x</li><li>docker.io/xebialabs/central-configuration:23.3.x</li><li>docker.io/xebialabs/tiny-tools:22.2.0</li><li>docker.io/xebialabs/deploy-operator:23.3.x</li><li>gcr.io/kubebuilder/kube-rbac-proxy:v0.8.0</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-nginx-include">If you are using nginx include<a aria-hidden="true" class="hash-link" href="#if-you-are-using-nginx-include" title="Direct link to heading">​</a></h4><ul><li>docker.io/bitnami/nginx:1.22.1-debian-11-r44</li><li>docker.io/bitnami/nginx-ingress-controller:1.6.4-debian-11-r5</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-haproxy-include">If you are using haproxy include<a aria-hidden="true" class="hash-link" href="#if-you-are-using-haproxy-include" title="Direct link to heading">​</a></h4><ul><li>quay.io/jcmoraisjr/haproxy-ingress:v0.14.2</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-embedded-keycloak-include">If you are using embedded keycloak include<a aria-hidden="true" class="hash-link" href="#if-you-are-using-embedded-keycloak-include" title="Direct link to heading">​</a></h4><ul><li>docker.io/jboss/keycloak:17.0.1</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-embedded-postgresql-include">If you are using embedded postgresql include<a aria-hidden="true" class="hash-link" href="#if-you-are-using-embedded-postgresql-include" title="Direct link to heading">​</a></h4><ul><li>docker.io/bitnami/postgresql:14.5.0-debian-11-r35</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-embedded-rabbitmq-include">If you are using embedded rabbitmq include<a aria-hidden="true" class="hash-link" href="#if-you-are-using-embedded-rabbitmq-include" title="Direct link to heading">​</a></h4><ul><li>docker.io/bitnami/rabbitmq:3.11.10-debian-11-r0</li><li>docker.io/bitnami/bitnami-shell:11-debian-11-r92</li></ul><h3 class="anchor anchorWithStickyNavbar_31ik" id="how-to-push-image-to-internally-accessible-docker-registry">How to push image to internally accessible docker registry<a aria-hidden="true" class="hash-link" href="#how-to-push-image-to-internally-accessible-docker-registry" title="Direct link to heading">​</a></h3><p>You need to pull the required images first on a bastion instance where public internet connectivity is there, then tag it and push it to your internally accessible docker image registry. Your kubernetes cluster will pull images from the docker registry.</p><p>For example with a docker registry at <code>myrepo_host</code>, the steps to push a docker image(for eg. xl-deploy) to the repository <code>myrepo</code> would be as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull docker.io/xebialabs/xl-deploy:22.3.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker tag docker.io/xebialabs/xl-deploy:22.3.1 myrepo_host/myrepo/xl-deploy:22.3.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker push myrepo_host/myrepo/xl-deploy:22.3.1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Make sure, you&#x27;re logged in to the docker registry before pushing the docker image.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_31ik" id="create-registry-secret-if-using-a-private-image-registry-protected-by-password">Create registry secret if using a private image registry protected by password<a aria-hidden="true" class="hash-link" href="#create-registry-secret-if-using-a-private-image-registry-protected-by-password" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret docker-registry regcred \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --docker-server=myrepo_host \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --docker-username=&lt;reg-user&gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --docker-password=&lt;reg-password&gt; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -n digitalai</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>This example creates a secret <code>regcred</code> which will be used for pull secrets for pulling image when using custom private image registry.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="use-xl-kube-install-to-install-using-custom-docker-image-registry-option">Use <code>xl kube install</code> to install using custom docker image registry option<a aria-hidden="true" class="hash-link" href="#use-xl-kube-install-to-install-using-custom-docker-image-registry-option" title="Direct link to heading">​</a></h3><p>When using custom docker registry, the operator image will be in the format <code>myrepo_host/myrepo/deploy-operator:image_tag</code></p><p>Here is example of the installation on minikube with a local docker registry running at <code>localhost:5000</code></p><p>In the below example the registry name is <code>localhost:5000</code>, the repository name is <code>myrepo</code>, so operator image would be like <code>localhost:5000/myrepo/deploy-operator:23.3.x</code>. Remember to override default answer and specify in this format. And also use the actual image tag version in place of <code>23.3.x</code></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">❯ xl kube install -l c:\proj\xl-op-blueprints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Following kubectl context will be used during execution: `minikube`? Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select the Kubernetes setup where the Digital.ai Devops Platform will be installed, updated or cleaned: PlainK8s [Plain multi-node K8s cluster]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Do you want to use an custom Kubernetes namespace (current default is &#x27;digitalai&#x27;): No</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Product server you want to perform install for: dai-deploy [Digital.ai Deploy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select type of image registry: public [Custom Public Registry (Uses a specific custom registry)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the custom docker image registry name: localhost:5000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the repository name (eg: &lt;repositoryName&gt; from &lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): myrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the deploy server image name (eg: &lt;imageName&gt; from &lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): xl-deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the image tag (eg: &lt;tagName&gt; from &lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): 23.3.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the deploy task engine image name for version 22 and above (eg: &lt;imageName&gt; from &lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): deploy-task-engine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the central configuration image name for version 22 and above (eg: &lt;imageName&gt; from &lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): central-configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the deploy master server replica count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter PVC size for Deploy master (Gi): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select between supported Access Modes: ReadWriteOnce [ReadWriteOnce]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the deploy worker replica count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter PVC size for Deploy worker (Gi): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter PVC size for Central Configuration (Gi): 0.500000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select between supported ingress types: haproxy [HAProxy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Do you want to enable an TLS/SSL configuration (if yes, requires existing TLS secret in the namespace): No</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide DNS name for accessing UI of the server: test.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide administrator password: 30Q5utfMV6O9wnHF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Type of the OIDC configuration: embedded [Embedded Keycloak Configuration]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Use embedded DB for keycloak: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter Keycloak public URL: k.test.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the operator image to use (eg: &lt;imageRegistryName&gt;/&lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): localhost:5000/myrepo/deploy-operator:23.3.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select source of the license: file [Path to the license file (the file can be in clean text or base64 encoded)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide license file for the server: c:\downloads\xld-license.lic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select source of the repository keystore: generate [Generate the repository keystore during installation (you need to have keytool utility installed in your path)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide keystore passphrase: 1uwAFCtUJEdwmaDi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide storage class for the server: standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Do you want to install a new PostgreSQL on the cluster: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide Storage Class to be defined for PostgreSQL: standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide PVC size for PostgreSQL (Gi): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Do you want to install a new RabbitMQ on the cluster: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Replica count to be defined for RabbitMQ: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Storage Class to be defined for RabbitMQ: standard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Provide PVC size for RabbitMQ (Gi): 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Do you want to proceed to the deployment with these values? Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For current process files will be generated in the: digitalai/dai-deploy/digitalai/20221020-001911/kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Generated answers file successfully: digitalai/generated_answers_dai-deploy_digitalai_install-20221020-001911.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting install processing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>After the install command completes successfully, you will see operator and other resources pods coming up and running.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="upgrade-steps">Upgrade steps<a aria-hidden="true" class="hash-link" href="#upgrade-steps" title="Direct link to heading">​</a></h2><p>Use <code>xl kube upgrade</code> to upgrade. It is similar to installation steps. Here the already installed cluster resources are overwritten/upgraded with the newly supplied values.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="example-of-running-upgrade-using-custom-docker-image-registry-option">Example of running upgrade using custom docker image registry option<a aria-hidden="true" class="hash-link" href="#example-of-running-upgrade-using-custom-docker-image-registry-option" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">❯ xl kube upgrade -l ./xl-op-blueprints</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Select type of image registry: public [Custom Public Registry (Uses a specific custom registry)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the custom docker image registry name: localhost:5000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the repository name (eg: &lt;repositoryName&gt; from &lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): myrepo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Enter the operator image to use (eg: &lt;imageRegistryName&gt;/&lt;repositoryName&gt;/&lt;imageName&gt;:&lt;tagName&gt;): localhost:5000/myrepo/deploy-operator:23.3.x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Edit list of custom resource keys that will migrate to the new Deploy CR: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">? Do you want to proceed to the deployment with these values? Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For current process files will be generated in the: digitalai/dai-deploy/digitalai/20221020-011911/kubernetes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Generated answers file successfully: digitalai/generated_answers_dai-deploy_digitalai_upgrade-20221020-011911.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting upgrade processing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>During upgrade for the question <code>Edit list of custom resource keys that will migrate to the new Deploy CR:</code> append to the list following keys:</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="for-default-image-registry">For Default image registry<a aria-hidden="true" class="hash-link" href="#for-default-image-registry" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">.spec.TinyToolsImageRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.defaultBackend.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.defaultBackend.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.haproxy-ingress.controller.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.volumePermissions.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.volumePermissions.image.repository</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="for-custom-docker-registry-public">For custom docker registry (public)<a aria-hidden="true" class="hash-link" href="#for-custom-docker-registry-public" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">.spec.TinyToolsImageRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.defaultBackend.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.global.imageRegistry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.haproxy-ingress.controller.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.global.imageRegistry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.global.imageRegistry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.volumePermissions.image.repository</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="for-custom-docker-registry-private">For custom docker registry (private)<a aria-hidden="true" class="hash-link" href="#for-custom-docker-registry-private" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">.spec.TinyToolsImageRepository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.defaultBackend.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.global.imageRegistry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.haproxy-ingress.controller.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.image.registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.global.imageRegistry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.global.imageRegistry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.volumePermissions.image.repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.nginx-ingress-controller.global.imagePullSecrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.imagePullSecrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.keycloak.postgresql.imagePullSecrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.postgresql.global.imagePullSecrets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.spec.rabbitmq.global.imagePullSecrets</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="image-repository-related-fields-that-are-getting-updated-in-installation-and-upgrade-process-by-xl-cli-when-using-custom-image-registry">Image repository related fields that are getting updated in Installation and Upgrade process by xl cli when using custom image registry<a aria-hidden="true" class="hash-link" href="#image-repository-related-fields-that-are-getting-updated-in-installation-and-upgrade-process-by-xl-cli-when-using-custom-image-registry" title="Direct link to heading">​</a></h2><h4 class="anchor anchorWithStickyNavbar_31ik" id="kubernetesdai-deploy_cryaml">kubernetes/dai-deploy_cr.yaml<a aria-hidden="true" class="hash-link" href="#kubernetesdai-deploy_cryaml" title="Direct link to heading">​</a></h4><ul><li>spec.centralConfiguration.image.repository: &quot;myrepo_host/myrepo/central-configuration&quot;</li><li>spec.ServerImageRepository: &quot;myrepo_host/myrepo/xl-deploy&quot;</li><li>spec.WorkerImageRepository: &quot;myrepo_host/myrepo/deploy-task-engine&quot;</li><li>spec.TinyToolsImageRepository: &quot;myrepo_host/myrepo/tiny-tools&quot;</li><li>spec.ImagePullSecret: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-nginx">If you are using nginx<a aria-hidden="true" class="hash-link" href="#if-you-are-using-nginx" title="Direct link to heading">​</a></h4><ul><li>spec.nginx-ingress-controller.defaultBackend.image.registry: myrepo_host</li><li>spec.nginx-ingress-controller.defaultBackend.image.repository: myrepo/nginx</li><li>spec.nginx-ingress-controller.image.registry: myrepo_host</li><li>spec.nginx-ingress-controller.image.repository: myrepo/nginx-ingress-controller</li><li>spec.nginx-ingress-controller.imagePullSecrets.<!-- -->[0]<!-- -->: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-haproxy">If you are using haproxy<a aria-hidden="true" class="hash-link" href="#if-you-are-using-haproxy" title="Direct link to heading">​</a></h4><ul><li>spec.haproxy-ingress.controller.image.repository: myrepo_host/myrepo/haproxy-ingress</li><li>spec.haproxy-ingress.imagePullSecrets<!-- -->[0]<!-- -->.name: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-embedded-keycloak">If you are using embedded keycloak<a aria-hidden="true" class="hash-link" href="#if-you-are-using-embedded-keycloak" title="Direct link to heading">​</a></h4><ul><li>spec.keycloak.image.repository: myrepo_host/myrepo/keycloak</li><li>spec.keycloak.postgresql.image.registry: myrepo_host</li><li>spec.keycloak.postgresql.image.repository: myrepo/postgresql</li><li>spec.keycloak.imagePullSecrets<!-- -->[0]<!-- -->.name: regcred (only for custom private image registry requiring authentication)</li><li>spec.keycloak.postgres.imagePullSecrets<!-- -->[0]<!-- -->.name: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-embedded-postgresql">If you are using embedded postgresql<a aria-hidden="true" class="hash-link" href="#if-you-are-using-embedded-postgresql" title="Direct link to heading">​</a></h4><ul><li>spec.postgresql.image.registry: myrepo_host</li><li>spec.postgresql.image.repository: myrepo/postgresql</li><li>spec.postgres.global.imagePullSecrets.<!-- -->[0]<!-- -->: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="if-you-are-using-embedded-rabbitmq">If you are using embedded rabbitmq<a aria-hidden="true" class="hash-link" href="#if-you-are-using-embedded-rabbitmq" title="Direct link to heading">​</a></h4><ul><li>spec.rabbitmq.image.registry: myrepo_host</li><li>spec.rabbitmq.image.repository: myrepo/rabbitmq</li><li>spec.rabbitmq.volumePermissions.image.registry: myrepo_host </li><li>spec.rabbitmq.volumePermissions.image.repository: myrepo/bitnami-shell</li><li>spec.rabbitmq.global.imagePullSecrets.<!-- -->[0]<!-- -->: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="kubernetestemplatedeploymentyaml">kubernetes/template/deployment.yaml<a aria-hidden="true" class="hash-link" href="#kubernetestemplatedeploymentyaml" title="Direct link to heading">​</a></h4><ul><li>spec.template.spec.containers<!-- -->[0]<!-- -->.image: myrepo_host/myrepo/kube-rbac-proxy:v0.8.0</li><li>spec.template.spec.containers<!-- -->[1]<!-- -->.image: myrepo_host/myrepo/deploy-operator:{operator-imageTag-given-in-xl-cmd-question}</li><li>spec.template.spec.imagePullSecrets<!-- -->[0]<!-- -->.name: regcred (only for custom private image registry requiring authentication)</li></ul><h4 class="anchor anchorWithStickyNavbar_31ik" id="kubernetestemplatepostgresql-init-keycloak-dbyaml">kubernetes/template/postgresql-init-keycloak-db.yaml<a aria-hidden="true" class="hash-link" href="#kubernetestemplatepostgresql-init-keycloak-dbyaml" title="Direct link to heading">​</a></h4><ul><li>spec.template.spec.initContainers<!-- -->[0]<!-- -->.image: myrepo_host/myrepo/tiny-tools:22.2.0</li><li>spec.template.spec.containers<!-- -->[0]<!-- -->.image: myrepo_host/myrepo/tiny-tools:22.2.0</li><li>spec.template.spec.imagePullSecrets<!-- -->[0]<!-- -->.name: regcred (only for custom private image registry requiring authentication)</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/xl-deploy-kubernetes-helm-chart/docs/integrating-with-identity-service"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->integrating-with-identity-service</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/xl-deploy-kubernetes-helm-chart/docs/operator-rbac"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">operator-rbac<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements" class="table-of-contents__link toc-highlight">Requirements</a></li><li><a href="#installation-steps" class="table-of-contents__link toc-highlight">Installation steps</a><ul><li><a href="#download-matching-version-of-the-xl-op-blueprints" class="table-of-contents__link toc-highlight">Download matching version of the xl-op-blueprints</a></li><li><a href="#get-the-operator-related-images-to-your-image-registry" class="table-of-contents__link toc-highlight">Get the operator related images to your image registry</a></li><li><a href="#how-to-push-image-to-internally-accessible-docker-registry" class="table-of-contents__link toc-highlight">How to push image to internally accessible docker registry</a></li><li><a href="#create-registry-secret-if-using-a-private-image-registry-protected-by-password" class="table-of-contents__link toc-highlight">Create registry secret if using a private image registry protected by password</a></li><li><a href="#use-xl-kube-install-to-install-using-custom-docker-image-registry-option" class="table-of-contents__link toc-highlight">Use <code>xl kube install</code> to install using custom docker image registry option</a></li></ul></li><li><a href="#upgrade-steps" class="table-of-contents__link toc-highlight">Upgrade steps</a><ul><li><a href="#example-of-running-upgrade-using-custom-docker-image-registry-option" class="table-of-contents__link toc-highlight">Example of running upgrade using custom docker image registry option</a></li><li><a href="#for-default-image-registry" class="table-of-contents__link toc-highlight">For Default image registry</a></li><li><a href="#for-custom-docker-registry-public" class="table-of-contents__link toc-highlight">For custom docker registry (public)</a></li><li><a href="#for-custom-docker-registry-private" class="table-of-contents__link toc-highlight">For custom docker registry (private)</a></li></ul></li><li><a href="#image-repository-related-fields-that-are-getting-updated-in-installation-and-upgrade-process-by-xl-cli-when-using-custom-image-registry" class="table-of-contents__link toc-highlight">Image repository related fields that are getting updated in Installation and Upgrade process by xl cli when using custom image registry</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/xl-deploy-kubernetes-helm-chart/docs/intro">Tutorial</a></li><li class="footer__item"><a href="https://github.com/xebialabs/xl-deploy-kubernetes-helm-chart" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Deploy Kubernetes Helm Chart Digital.ai</div></div></div></footer></div>
<script src="/xl-deploy-kubernetes-helm-chart/assets/js/runtime~main.2d393b82.js"></script>
<script src="/xl-deploy-kubernetes-helm-chart/assets/js/main.28544d81.js"></script>
</body>
</html>